---
- name: Prompt for containerd restart
  ansible.builtin.pause:
    prompt: "Containerd configuration changed on {{ inventory_hostname }}. Do you want to restart containerd? (yes/no)"
  register: kubernetes_containerd_restart_confirm
  run_once: false

- name: Restart containerd
  ansible.builtin.systemd:
    name: containerd
    state: restarted
  when: kubernetes_containerd_restart_confirm.user_input | default('no') | lower in ['yes', 'y']

- name: Restart kubelet
  ansible.builtin.systemd:
    name: kubelet
    state: restarted
